!function(){var t,e,n,r,o,i,a,u,c={};function l(t,e,n,r,o,i,a){try{var u=t[i](a),c=u.value}catch(t){n(t);return}u.done?e(c):Promise.resolve(c).then(r,o)}function s(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function h(t,e){if(t){if("string"==typeof t)return f(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if("Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(t,e)}}function d(t){return function(t){if(Array.isArray(t))return f(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||h(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}"function"==typeof SuppressedError&&SuppressedError;var v="idle",y="playing",m=function(t){for(var e=Math.floor(4*Math.random());!t[e].includes(0);)e=Math.floor(4*Math.random());for(var n=Math.floor(4*Math.random());0!==t[e][n];)n=Math.floor(4*Math.random());return[e,n]},g=function(t){var e,n=t.map(function(t){return d(t)}),r=.9>=Math.random()?2:4,o=function(t){if(Array.isArray(t))return t}(e=m(n))||function(t,e){var n,r,o=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=o){var i=[],a=!0,u=!1;try{for(o=o.call(t);!(a=(n=o.next()).done)&&(i.push(n.value),2!==i.length);a=!0);}catch(t){u=!0,r=t}finally{try{a||null==o.return||o.return()}finally{if(u)throw r}}return i}}(e,2)||h(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),i=o[0],a=o[1];return n[i][a]=r,n},p=function(){var t=g([[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]);return g(t)},b=function(t){for(var e=!0,n=0;n<t.length;n+=1)for(var r=[t.length-1,t[t.length-1][n]],o=null,i=t.length-1;i>=0;i-=1){var a=t[i][n];if(0===a){if(null!==o)continue;o=i;continue}if(r[1]===a&&r[0]!==i){t[r[0]][n]=2*a,t[i][n]=0,o=i,r[0]-=1,i+=1,r[1]=t[r[0]][n],e=!1;continue}if(null!==o){t[o][n]=a,r[0]=o,r[1]=a,o-=1,t[i][n]=0,e=!1;continue}if(r[1]!==a){r[0]-=1,r[1]=a;continue}}return!e&&t},S=function(t){for(var e=!0,n=0;n<t.length;n+=1)for(var r=t[n],o=[0,r[0]],i=null,a=0;a<r.length;a+=1){var u=r[a];if(0===u){if(null!==i)continue;i=a;continue}if(o[1]===u&&o[0]!==a){t[n][o[0]]=2*u,t[n][a]=0,i=a,o[0]+=1,a-=1,o[1]=t[a][o[0]],e=!1;continue}if(null!==i){t[n][i]=u,o[0]=i,o[1]=u,i+=1,t[n][a]=0,e=!1;continue}if(o[1]!==u){o[0]+=1,o[1]=u;continue}}return!e&&t},w=function(t){for(var e=!0,n=0;n<t.length;n+=1)for(var r=t[n],o=[r.length-1,r[r.length-1]],i=null,a=r.length-1;a>=0;a-=1){var u=r[a];if(0===u){if(null!==i)continue;i=a;continue}if(o[1]===u&&o[0]!==a){t[n][o[0]]=2*u,t[n][a]=0,i=a,o[0]-=1,a+=1,o[1]=t[a][o[0]],e=!1;continue}if(null!==i){t[n][i]=u,o[0]=i,o[1]=u,i-=1,t[n][a]=0,e=!1;continue}if(o[1]!==u){o[0]-=1,o[1]=u;continue}}return!e&&t},k=function(t){for(var e=!0,n=0;n<t.length;n+=1)for(var r=[0,t[0][n]],o=null,i=0;i<t.length;i+=1){var a=t[i][n];if(0===a){if(null!==o)continue;o=i;continue}if(r[1]===a&&r[0]!==i){t[r[0]][n]=2*a,t[i][n]=0,o=i,r[0]+=1,i-=1,r[1]=t[r[0]][n],e=!1;continue}if(null!==o){t[o][n]=a,r[0]=o,r[1]=a,o+=1,t[i][n]=0,e=!1;continue}if(r[1]!==a){r[0]+=1,r[1]=a;continue}}return!e&&t},L=function(t){d(document.querySelector("tbody").children).forEach(function(e,n){d(e.children).forEach(function(e,r){if(e.children.length)e.lastChild.classList.add("hide"),new Promise(function(t){setTimeout(function(){return t()},75)}).then(function(){e.removeChild(e.lastChild);var o=document.createElement("div");o.classList.add("field-cell"),o.style.cssText="display: flex; justify-content: center; align-items: center;";var i=t[n][r];i&&o.classList.add("field-cell--".concat(i)),o.textContent=0===i?"":i,e.append(o)});else{var o=document.createElement("div");o.classList.add("field-cell"),o.style.cssText="display: flex; justify-content: center; align-items: center;";var i=t[n][r];i&&o.classList.add("field-cell--".concat(i)),o.textContent=0===i?"":i,e.append(o)}})})};c=function(){var t;function e(t){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,e),s(this,"state",[]),s(this,"status",v),this.state=t}return t=[{key:"moveLeft",value:function(){if(this.getStatus()===y){var t=S(this.getState());this.applyChanges(t)}}},{key:"moveRight",value:function(){if(this.getStatus()===y){var t=w(this.getState());this.applyChanges(t)}}},{key:"moveUp",value:function(){if(this.getStatus()===y){var t=k(this.getState());this.applyChanges(t)}}},{key:"moveDown",value:function(){if(this.getStatus()===y){var t=b(this.getState());this.applyChanges(t)}}},{key:"getScore",value:function(){return this.status===v?0:this.state.flat().reduce(function(t,e){return t+e},0)}},{key:"getState",value:function(){return this.state.map(function(t){return d(t)})}},{key:"getStatus",value:function(){return this.status}},{key:"start",value:function(){this.status=y,L(this.getState())}},{key:"restart",value:function(){this.state=p(),L(this.getState()),this.status=y,document.querySelectorAll(".message").forEach(function(t){t.classList.contains("hidden")||t.classList.add("hidden")})}},{key:"applyChanges",value:function(t){var e,n=this;return(e=function(){var e;return function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(c){return function(u){if(n)throw TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===u[0]||2===u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=e.call(t,a)}catch(t){u=[6,t],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}}(this,function(r){switch(r.label){case 0:return[4,n.isFull(t)];case 1:if(r.sent())return n.gameOver(),[2];if(!t)return[2];return e=g(t),n.state=e,L(e),n.has2048(n.state)&&n.winner(),[2]}})},function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(t){l(i,r,o,a,u,"next",t)}function u(t){l(i,r,o,a,u,"throw",t)}a(void 0)})})()}},{key:"isFull",value:function(t){var e=this;if(!t)return new Promise(function(t,n){if(w(e.getState()))return!1;t()}).then(function(){if(S(e.getState()))return!1}).then(function(){if(k(e.getState()))return!1}).then(function(){return!b(e.getState())})}},{key:"gameOver",value:function(){this.status="lose",document.querySelector(".message-lose").classList.remove("hidden")}},{key:"has2048",value:function(t){return t.flat().includes(2048)}},{key:"winner",value:function(){this.status="win",document.querySelector(".message-win").classList.remove("hidden")}}],function(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(e.prototype,t),e}();var C=document.querySelector(".controls button"),x=document.querySelector(".game-score"),E=new c(p());document.body.style.overflowY="hidden",C.addEventListener("click",function(){C.classList.contains("start")?(C.classList.remove("start"),C.classList.add("restart"),C.textContent="Restart",E.start()):E.restart(),document.querySelector(".message-start").classList.add("hidden");var t=E.getScore();x.textContent=t}),document.addEventListener("keydown",function(t){if("ArrowRight"===t.key){E.moveRight();var e=E.getScore();x.textContent=e}if("ArrowLeft"===t.key){E.moveLeft();var n=E.getScore();x.textContent=n}if("ArrowUp"===t.key){E.moveUp();var r=E.getScore();x.textContent=r}if("ArrowDown"===t.key){E.moveDown();var o=E.getScore();x.textContent=o}}),t=function(){Math.abs(r-o)>Math.abs(i-a)?(r-o>u&&E.moveLeft(),o-r>u&&E.moveRight()):(i-a>u&&E.moveUp(),a-i>u&&E.moveDown());var t=E.getScore();n.textContent=t},e=document.querySelector("tbody"),n=document.querySelector(".game-score"),r=0,o=0,i=0,a=0,u=20,e.addEventListener("touchstart",function(t){r=t.changedTouches[0].screenX,i=t.changedTouches[0].screenY}),e.addEventListener("touchend",function(e){o=e.changedTouches[0].screenX,a=e.changedTouches[0].screenY,t()})}();
//# sourceMappingURL=index.56cf2066.js.map
